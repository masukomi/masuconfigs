#!/usr/bin/env bash

git log --stat -n1 | grep --color=never  "^ *.*\.org *|" > /dev/null

# test if the grep matched anything
if [ $? -eq 0 ]; then
	printf "\033[1mChanges:\033[0m\n"
	script -q  /dev/null git log --stat=60 -n1 \
		| grep --color=never  "^ *.*\.org *|" \
		| sed -e "s/^ */         /"

	printf "\n\033[1mWord Counts:\033[0m\n"
	# list all the files
	# pipe that list to wc, and then to numfmt
	# This *will* error if a file has been deleted,
	#   but making this into a loop sounds like a
	#   pain in the arse.
	git log --name-only -n1 --format="" \
		| xargs wc -w \
		| numfmt --grouping

	#numfmt is not a POSIX utility. It comes from GNU coreutils
else
	echo "No .org files in last commit."
fi
